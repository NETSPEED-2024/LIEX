<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Generador de Datos â€” Creado por William Campal 09/11/2025</title>
<style>
:root{--primary:#2c3e50;--secondary:#3498db;--danger:#e74c3c}
body{font-family:Inter,"Segoe UI",Tahoma,sans-serif;background:#f4f6f8;margin:0;color:#222}
header{background:var(--primary);color:#fff;padding:14px;text-align:center}
header h1{margin:0;font-size:18px}
.container{max-width:1100px;margin:12px auto;padding:0 12px}
.card{background:#fff;border-radius:10px;padding:12px;margin-bottom:12px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
label{display:block;font-weight:600;margin-top:10px}
textarea,input,select{width:100%;padding:10px;border:1px solid #dcdfe6;border-radius:6px;font-size:14px;box-sizing:border-box}
.btn{background:var(--secondary);color:#fff;border:0;padding:10px 12px;border-radius:6px;margin:6px 6px 6px 0;cursor:pointer}
.btn-danger{background:var(--danger)}
.out{background:#fbfdff;border:1px solid #e6eef9;padding:10px;border-radius:6px;min-height:160px;white-space:pre-wrap;font-family:monospace}
.small{font-size:13px;color:#555;margin-top:6px}
footer{padding:12px;text-align:center;font-size:13px;color:#666}
fieldset{border:1px solid #e3e6ea;border-radius:8px;padding:8px;margin-top:10px}
legend{font-weight:700}
@media(max-width:800px){header h1{font-size:16px}.btn{width:48%;margin:6px 1%}}
</style>
</head>
<body>
<header><h1>Generador de Datos â€” Creado por William Campal</h1></header>

<div class="container">

<div class="card">
  <h3>ğŸ“‹ Procesar desde Excel</h3>

  <label>Seleccionar plantilla</label>
  <select id="sheetType">
    <option value="203">203</option>
    <option value="302">302</option>
    <option value="402-403">402-403</option>
    <option value="brine">BRINE</option>
    <option value="li2co3">Liâ‚‚COâ‚ƒ</option>
    <option value="reporte_id">Reporte I+D</option>
  </select>

  <label>Pegar filas copiadas desde Excel</label>
  <textarea id="excelData" placeholder="Pega aquÃ­ las filas copiadas desde Excel..."></textarea>

  <div>
    <button class="btn" onclick="pegarDesdePortapapeles()">ğŸ“‹ Pegar</button>
    <button class="btn" onclick="procesarExcel()">âš™ï¸ Procesar</button>
    <button class="btn btn-danger" onclick="limpiar()">ğŸ§¹ Limpiar</button>
  </div>

  <label>Salida generada</label>
  <div id="salida" class="out">AquÃ­ aparecerÃ¡ el texto listo para copiar o enviar por WhatsApp.</div>

  <div>
    <button class="btn" onclick="copiarSalida()">ğŸ“„ Copiar</button>
    <button class="btn" onclick="abrirWhatsappPrimerRegistro()">ğŸ’¬ WhatsApp</button>
  </div>
</div>

<div class="card">
  <h3>ğŸ§ª Crear muestra manual</h3>

  <label>Tipo de muestra</label>
  <select id="tipoManual">
    <option value="liquido">LÃ­quido</option>
    <option value="solido">SÃ³lido</option>
  </select>

  <fieldset>
    <legend>Seleccionar analitos</legend>
    <div id="analitosSelect" style="display:flex;flex-wrap:wrap;gap:6px"></div>
  </fieldset>

  <label>IdentificaciÃ³n</label>
  <input id="identManual"/>

  <label>CÃ³digo</label>
  <input id="codigoManual"/>

  <div id="analitosCampos"></div>

  <div>
    <button class="btn" onclick="generarManual()">Generar formato</button>
    <button class="btn btn-danger" onclick="borrarManual()">Borrar</button>
  </div>

  <label>Salida manual</label>
  <div id="salidaManual" class="out"></div>
  <div>
    <button class="btn" onclick="copiarManual()">ğŸ“‹ Copiar</button>
    <button class="btn" onclick="whatsappManual()">ğŸ’¬ WhatsApp</button>
  </div>
</div>

<footer>Generador de Datos â€” Creado por William Campal Â© 2025</footer>
</div>

<script>
/* =================== PLANTILLAS =================== */
const plantillas={

"203":[
  { nombre:"IdentificaciÃ³n", i:0 },
  { nombre:"CÃ³digo", i:1 },

  { nombre:"Ca", i:2, u:"mg/L" },
  { nombre:"Li", i:3, u:"mg/L" },
  { nombre:"pH", i:4 },

  { nombre:"Mg", i:5, u:"mg/L" },
  { nombre:"Na", i:6, u:"mg/L" },
  { nombre:"K", i:7, u:"mg/L" },
  { nombre:"Fe", i:8, u:"mg/L" },
  { nombre:"SO4", i:9, u:"mg/L" },
  { nombre:"CO3", i:10, u:"mg/L" },
  { nombre:"HCO3", i:11, u:"mg/L" },
  { nombre:"OH", i:12, u:"mg/L" },

  { nombre:"densidad", i:13, u:"g/ml" },
  { nombre:"Conductividad", i:14, u:"ÂµS/cm" },
  { nombre:"Turbidez", i:15, u:"NTU" },
  { nombre:"OD", i:16, u:"%" },
  { nombre:"Pureza", i:17, u:"%" }
],

"302":[
  { nombre:"IdentificaciÃ³n", i:0 },
  { nombre:"CÃ³digo", i:1 },
  { nombre:"B", i:2, u:"ppm" },
  { nombre:"Ca", i:3, u:"ppm" },
  { nombre:"K", i:4, u:"ppm" },
  { nombre:"Li", i:5, u:"ppm" },
  { nombre:"Mg", i:6, u:"ppm" },
  { nombre:"Na", i:7, u:"ppm" },
  { nombre:"densidad", i:8, u:"g/ml" },
  { nombre:"pH", i:9 },
  { nombre:"Na2CO3", i:10, u:"%" },
  { nombre:"temperatura", i:11, u:"Â°C" },
  { nombre:"CO3", i:12, u:"ppm" },
  { nombre:"HCO3", i:13, u:"ppm" },
  { nombre:"NaOH", i:14, u:"ppm" },
  { nombre:"OH", i:15, u:"ppm" },
  { nombre:"Fe", i:16, u:"ppm" },
  { nombre:"% SÃ³lidos", i:17, u:"%" },
  { nombre:"Conductividad", i:18, u:"ÂµS/cm" },
  { nombre:"TDS", i:19, u:"ppm" },
  { nombre:"Cloruros", i:20, u:"%" },
  { nombre:"Salinidad", i:21, u:"%" },
  { nombre:"Turbidez", i:22, u:"NTU" },
  { nombre:"Cloro Libre", i:23, u:"mg/L" },
  { nombre:"OD", i:24, u:"%" }
],

"402-403":[
 {nombre:"IdentificaciÃ³n",i:0},
 {nombre:"CÃ³digo",i:1},
 {nombre:"B",i:2,u:"mg/L"},
 {nombre:"Ca",i:3,u:"mg/L"},
 {nombre:"K",i:4,u:"mg/L"},
 {nombre:"Li",i:5,u:"mg/L"},
 {nombre:"Mg",i:6,u:"mg/L"},
 {nombre:"Na",i:7,u:"mg/L"},
 {nombre:"Fe",i:8,u:"mg/L"},
 {nombre:"SO4",i:9,u:"mg/L"},
 {nombre:"CO3",i:10,u:"mg/L"},
 {nombre:"HCO3",i:11,u:"mg/L"},
 {nombre:"pH",i:12},
 {nombre:"Densidad",i:13,u:"g/ml"},
 {nombre:"Conductividad",i:14,u:"ÂµS/cm"}
],

"brine":[
 {nombre:"IdentificaciÃ³n",i:0},
 {nombre:"CÃ³digo",i:1},
 {nombre:"Ca",i:2,u:"mg/L"},
 {nombre:"K",i:3,u:"mg/L"},
 {nombre:"Li",i:4,u:"mg/L"},
 {nombre:"Mg",i:5,u:"mg/L"},
 {nombre:"Na",i:6,u:"mg/L"},
 {nombre:"SO4",i:7,u:"mg/L"},
 {nombre:"CO3",i:8,u:"mg/L"},
 {nombre:"HCO3",i:9,u:"mg/L"},
 {nombre:"Cl",i:10,u:"mg/L"},
 {nombre:"pH",i:11},
 {nombre:"Densidad",i:12,u:"g/ml"}
],

"li2co3":[
 {nombre:"IdentificaciÃ³n",i:0},
 {nombre:"CÃ³digo",i:1},
 {nombre:"Li2CO3 %",i:2,u:"%"},
 {nombre:"Na",i:3,u:"mg/kg"},
 {nombre:"K",i:4,u:"mg/kg"},
 {nombre:"Ca",i:5,u:"mg/kg"},
 {nombre:"Mg",i:6,u:"mg/kg"},
 {nombre:"Fe",i:7,u:"mg/kg"},
 {nombre:"Ni",i:8,u:"mg/kg"},
 {nombre:"Mn",i:9,u:"mg/kg"},
 {nombre:"Cu",i:10,u:"mg/kg"},
 {nombre:"Zn",i:11,u:"mg/kg"},
 {nombre:"pH",i:12}
],

"reporte_id":[
 {nombre:"IdentificaciÃ³n",i:0},
 {nombre:"CÃ³digo",i:1},
 {nombre:"Ensayo",i:2},
 {nombre:"Resultado",i:3},
 {nombre:"Unidad",i:4},
 {nombre:"Observaciones",i:5}
]
};

/* =================== PROCESAR =================== */
function clean(v){return v?v.toString().trim():"";}

function procesarExcel(){
 const raw=document.getElementById("excelData").value.trim();
 if(!raw){alert("PegÃ¡ filas desde Excel.");return;}
 const rows=raw.replace(/\r/g,"").split(/\n/).filter(r=>r.trim()!="");
 const parsed=rows.map(l=>l.split(/\t|;/).map(x=>x.trim()));
 const plantilla=plantillas[document.getElementById("sheetType").value];

 let salida="";
 parsed.forEach(r=>{
   if(r.length<2)return;
   let id=clean(r[0]),cod=clean(r[1]);
   if(!id&&!cod)return;

   salida+=`ğŸ”¹ IdentificaciÃ³n: ${id}\nğŸ”¹ CÃ³digo: ${cod}\n`;

   plantilla.forEach((c,j)=>{
     if(j<2)return;
     let v=r[c.i]||"";
     if(!v&&v.toUpperCase()!="N/D")return;
     salida+=`â€¢ ${c.nombre}: ${v}${c.u?" "+c.u:""}\n`;
   });

   salida+="-------------------------\n";
 });

 document.getElementById("salida").textContent=salida||"No hay datos vÃ¡lidos.";
}

/* =================== UTILIDADES =================== */
async function pegarDesdePortapapeles(){try{document.getElementById("excelData").value=await navigator.clipboard.readText();}catch{alert("PegÃ¡ manualmente.")}}
function copiarSalida(){const t=document.getElementById("salida").textContent;if(!t.trim())return;navigator.clipboard.writeText(t).then(()=>alert("Copiado âœ…"))}
function abrirWhatsappPrimerRegistro(){const t=document.getElementById("salida").textContent.trim();if(!t)return;const f=t.split("-------------------------")[0];window.open("https://web.whatsapp.com/send?text="+encodeURIComponent(f),"_blank")}
function limpiar(){document.getElementById("excelData").value="";document.getElementById("salida").textContent="";}

/* =================== MANUAL =================== */
const analitos=["B","Ca","K","Li","Mg","Na","Fe","SO4","CO3","HCO3","Si","Cl","Ni","Mn","Cu","Zn","pH","Densidad","Conductividad","Turbidez","Li2CO3 %","Ensayo","Resultado","Unidad","Observaciones"];
function crearCheckbox(){
 const c=document.getElementById("analitosSelect");c.innerHTML="";
 analitos.forEach(a=>{c.innerHTML+=`<label><input type="checkbox" value="${a}" onchange="mostrarCampos()"> ${a}</label>`});
}
function mostrarCampos(){
 const sel=[...document.querySelectorAll("#analitosSelect input:checked")].map(i=>i.value);
 const cont=document.getElementById("analitosCampos");cont.innerHTML="";
 sel.forEach(a=>cont.innerHTML+=`<label>${a}</label><input id="a_${a.replace(/\W+/g,'')}" placeholder="${a}">`);
}
function generarManual(){
 const tipo=document.getElementById("tipoManual").value;
 const id=document.getElementById("identManual").value.trim();
 const cod=document.getElementById("codigoManual").value.trim();
 if(!id||!cod)return alert("CompletÃ¡ IdentificaciÃ³n y CÃ³digo.");
 const sel=[...document.querySelectorAll("#analitosSelect input:checked")].map(i=>i.value);
 let out=`ğŸ”¹ IdentificaciÃ³n: ${id}\nğŸ”¹ CÃ³digo: ${cod}\n`;
 sel.forEach(a=>{
   const v=document.getElementById("a_"+a.replace(/\W+/g,'')).value.trim();
   if(!v&&v.toUpperCase()!="N/D")return;
   let u="";
   if(["B","Ca","K","Li","Mg","Na","Fe","SO4","CO3","HCO3","Si","Cl","Ni","Mn","Cu","Zn"].includes(a))u=tipo=="solido"?"mg/kg":"mg/L";
   else if(a=="Densidad")u="g/ml";
   else if(a=="Conductividad")u="ÂµS/cm";
   else if(a=="Turbidez")u="NTU";
   out+=`â€¢ ${a}: ${v}${u?" "+u:""}\n`;
 });
 out+="-------------------------";
 document.getElementById("salidaManual").textContent=out;
 document.getElementById("salida").textContent=out;
}
function copiarManual(){const t=document.getElementById("salidaManual").textContent;if(!t.trim())return;navigator.clipboard.writeText(t).then(()=>alert("Copiado âœ…"))}
function whatsappManual(){const t=document.getElementById("salidaManual").textContent.trim();if(!t)return;window.open("https://web.whatsapp.com/send?text="+encodeURIComponent(t),"_blank")}
function borrarManual(){document.getElementById("analitosCampos").innerHTML="";document.getElementById("identManual").value="";document.getElementById("codigoManual").value="";document.querySelectorAll("#analitosSelect input").forEach(c=>c.checked=false);document.getElementById("salidaManual").textContent="";}
crearCheckbox();
</script>
</body>
</html>
